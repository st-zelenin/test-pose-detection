parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Oo4e":[function(require,module,exports) {
LZWEncoder=function(){var n,t,i,o,r,e,f,c,u,a,s,w,y={},d=[],B=[],h=0,l=!1,p=0,v=0,m=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],E=[],L=y.LZWEncoder=function(r,e,f,c){n=r,t=e,i=f,o=Math.max(2,c)},W=function(n,t){E[w++]=n,w>=254&&b(t)},Z=function(n){x(5003),h=a+2,l=!0,k(a,n)},x=function(n){for(var t=0;t<n;++t)d[t]=-1},M=y.compress=function(n,t){var i,o,r,e,y,p;for(l=!1,c=g(f=u=n),s=(a=1<<n-1)+1,h=a+2,w=0,e=j(),p=0,i=5003;i<65536;i*=2)++p;p=8-p,x(5003),k(a,t);n:for(;-1!=(r=j());)if(i=(r<<12)+e,d[o=r<<p^e]!=i){if(d[o]>=0){y=5003-o,0===o&&(y=1);do{if((o-=y)<0&&(o+=5003),d[o]==i){e=B[o];continue n}}while(d[o]>=0)}k(e,t),e=r,h<4096?(B[o]=h++,d[o]=i):Z(t)}else e=B[o];k(e,t),k(s,t)},b=(y.encode=function(i){i.writeByte(o),r=n*t,e=0,M(o+1,i),i.writeByte(0)},function(n){w>0&&(n.writeByte(w),n.writeBytes(E,0,w),w=0)}),g=function(n){return(1<<n)-1},j=function(){return 0===r?-1:(--r,255&i[e++])},k=function(n,t){for(p&=m[v],v>0?p|=n<<v:p=n,v+=f;v>=8;)W(255&p,t),p>>=8,v-=8;if((h>c||l)&&(l?(c=g(f=u),l=!1):c=12==++f?4096:g(f)),n==s){for(;v>0;)W(255&p,t),p>>=8,v-=8;b(t)}};return L.apply(this,arguments),y};
},{}],"cKHy":[function(require,module,exports) {
NeuQuant=function(){var r,n,f,o,t,a={},u=[],c=[],i=[],e=[],v=a.NeuQuant=function(r,a,u){var e,v;for(n=r,f=a,o=u,t=new Array(256),e=0;e<256;e++)t[e]=new Array(4),(v=t[e])[0]=v[1]=v[2]=(e<<12)/256,i[e]=256,c[e]=0},y=(a.map=function(r,n,f){var o,a,c,i,e,v,y;for(e=1e3,y=-1,a=(o=u[n])-1;o<256||a>=0;)o<256&&((c=(v=t[o])[1]-n)>=e?o=256:(o++,c<0&&(c=-c),(i=v[0]-r)<0&&(i=-i),(c+=i)<e&&((i=v[2]-f)<0&&(i=-i),(c+=i)<e&&(e=c,y=v[3])))),a>=0&&((c=n-(v=t[a])[1])>=e?a=-1:(a--,c<0&&(c=-c),(i=v[0]-r)<0&&(i=-i),(c+=i)<e&&((i=v[2]-f)<0&&(i=-i),(c+=i)<e&&(e=c,y=v[3]))));return y},a.process=function(){return function(){var t,a,u,c,i,v,y,w,A,N,Q,l,m,b;for(f<1509&&(o=1),r=30+(o-1)/3,l=n,m=0,b=f,N=(Q=f/(3*o))/100|0,w=1024,(y=(v=2048)>>6)<=1&&(y=0),t=0;t<y;t++)e[t]=w*(256*(y*y-t*t)/(y*y));for(A=f<1509?3:f%499!=0?1497:f%491!=0?1473:f%487!=0?1461:1509,t=0;t<Q;)if(u=(255&l[m+0])<<4,c=(255&l[m+1])<<4,i=(255&l[m+2])<<4,a=s(u,c,i),h(w,a,u,c,i),0!==y&&p(y,a,u,c,i),(m+=A)>=b&&(m-=f),0===N&&(N=1),++t%N==0)for(w-=w/r,(y=(v-=v/30)>>6)<=1&&(y=0),a=0;a<y;a++)e[a]=w*(256*(y*y-a*a)/(y*y))}(),y(),function(){var r,n,f,o,a,c,i,e;for(i=0,e=0,r=0;r<256;r++){for(f=r,o=(a=t[r])[1],n=r+1;n<256;n++)(c=t[n])[1]<o&&(f=n,o=c[1]);if(c=t[f],r!=f&&(n=c[0],c[0]=a[0],a[0]=n,n=c[1],c[1]=a[1],a[1]=n,n=c[2],c[2]=a[2],a[2]=n,n=c[3],c[3]=a[3],a[3]=n),o!=i){for(u[i]=e+r>>1,n=i+1;n<o;n++)u[n]=r;i=o,e=r}}for(u[i]=e+255>>1,n=i+1;n<256;n++)u[n]=255}(),function(){for(var r=[],n=new Array(256),f=0;f<256;f++)n[t[f][3]]=f;for(var o=0,a=0;a<256;a++){var u=n[a];r[o++]=t[u][0],r[o++]=t[u][1],r[o++]=t[u][2]}return r}()},function(){var r;for(r=0;r<256;r++)t[r][0]>>=4,t[r][1]>>=4,t[r][2]>>=4,t[r][3]=r}),p=function(r,n,f,o,a){var u,c,i,v,y,p,h;for((i=n-r)<-1&&(i=-1),(v=n+r)>256&&(v=256),u=n+1,c=n-1,p=1;u<v||c>i;){if(y=e[p++],u<v){h=t[u++];try{h[0]-=y*(h[0]-f)/(1<<18),h[1]-=y*(h[1]-o)/(1<<18),h[2]-=y*(h[2]-a)/(1<<18)}catch(s){}}if(c>i){h=t[c--];try{h[0]-=y*(h[0]-f)/(1<<18),h[1]-=y*(h[1]-o)/(1<<18),h[2]-=y*(h[2]-a)/(1<<18)}catch(s){}}}},h=function(r,n,f,o,a){var u=t[n];u[0]-=r*(u[0]-f)/1024,u[1]-=r*(u[1]-o)/1024,u[2]-=r*(u[2]-a)/1024},s=function(r,n,f){var o,a,u,e,v,y,p,h,s,w;for(s=h=~(1<<31),p=y=-1,o=0;o<256;o++)(a=(w=t[o])[0]-r)<0&&(a=-a),(u=w[1]-n)<0&&(u=-u),a+=u,(u=w[2]-f)<0&&(u=-u),(a+=u)<h&&(h=a,y=o),(e=a-(c[o]>>12))<s&&(s=e,p=o),v=i[o]>>10,i[o]-=v,c[o]+=v<<10;return i[y]+=64,c[y]-=65536,p};return v.apply(this,arguments),a};
},{}],"Zeem":[function(require,module,exports) {
GIFEncoder=function(){for(var t=0,e={};t<256;t++)e[t]=String.fromCharCode(t);function n(){this.bin=[]}n.prototype.getData=function(){for(var t="",n=this.bin.length,r=0;r<n;r++)t+=e[this.bin[r]];return t},n.prototype.writeByte=function(t){this.bin.push(t)},n.prototype.writeUTFBytes=function(t){for(var e=t.length,n=0;n<e;n++)this.writeByte(t.charCodeAt(n))},n.prototype.writeBytes=function(t,e,n){for(var r=n||t.length,i=e||0;i<r;i++)this.writeByte(t[i])};var r,i,a,o,c,l,u,f,s,w={},y=null,h=-1,d=0,B=!1,g=[],v=7,m=-1,p=!1,b=!0,F=!1,U=10,C="Generated by jsgif (https://github.com/antimatter15/jsgif/)",D=(w.setDelay=function(t){d=Math.round(t/10)},w.setDispose=function(t){t>=0&&(m=t)},w.setRepeat=function(t){t>=0&&(h=t)},w.setTransparent=function(t){y=t},w.setComment=function(t){C=t},w.addFrame=function(t,e){if(null===t||!B||null===o)throw new Error("Please call start method before calling addFrame");var n=!0;try{e?t instanceof ImageData?(c=t.data,F&&r==t.width&&i==t.height||E(t.width,t.height)):t instanceof Uint8ClampedArray?t.length==r*i*4?c=t:(console.log("Please set the correct size: ImageData length mismatch"),n=!1):(console.log("Please provide correct input"),n=!1):(c=t.getImageData(0,0,t.canvas.width,t.canvas.height).data,F||E(t.canvas.width,t.canvas.height)),I(),P(),b&&(G(),S(),h>=0&&L()),A(),""!==C&&R(),j(),b||S(),M(),b=!1}catch(a){n=!1}return n},w.download=function(t){if(null===o||0==p)console.log("Please call start method and add frames and call finish method before calling download");else{t=void 0!==t?t.endsWith(".gif")?t:t+".gif":"download.gif";var e=document.createElement("a");e.download=t,e.href=URL.createObjectURL(new Blob([new Uint8Array(o.bin)],{type:"image/gif"})),e.click()}},w.finish=function(){if(!B)return!1;var t=!0;B=!1;try{o.writeByte(59),p=!0}catch(e){t=!1}return t},function(){a=0,c=null,l=null,u=null,s=null,p=!1,b=!0}),E=(w.setFrameRate=function(t){15!=t&&(d=Math.round(100/t))},w.setQuality=function(t){t<1&&(t=1),U=t},w.setSize=function(t,e){B&&!b||((r=t)<1&&(r=320),(i=e)<1&&(i=240),F=!0)}),P=(w.start=function(){D();var t=!0;p=!1,o=new n;try{o.writeUTFBytes("GIF89a")}catch(e){t=!1}return B=t},w.cont=function(){D();return p=!1,o=new n,B=!0},function(){var t=l.length,e=t/3;u=[];var n=new NeuQuant(l,t,U);s=n.process();for(var r=0,i=0;i<e;i++){var o=n.map(255&l[r++],255&l[r++],255&l[r++]);g[o]=!0,u[i]=o}l=null,f=8,v=7,null!==y&&(a=T(y))}),T=function(t){if(null===s)return-1;for(var e=(16711680&t)>>16,n=(65280&t)>>8,r=255&t,i=0,a=16777216,o=s.length,c=0;c<o;){var l=e-(255&s[c++]),u=n-(255&s[c++]),f=r-(255&s[c]),w=l*l+u*u+f*f,y=c/3;g[y]&&w<a&&(a=w,i=y),c++}return i},I=function(){var t=r,e=i;l=[];for(var n=c,a=0,o=0;o<e;o++)for(var u=0;u<t;u++){var f=o*t*4+4*u;l[a++]=n[f],l[a++]=n[f+1],l[a++]=n[f+2]}},A=function(){var t,e;o.writeByte(33),o.writeByte(249),o.writeByte(4),null===y?(t=0,e=0):(t=1,e=2),m>=0&&(e=7&m),e<<=2,o.writeByte(0|e|t),z(d),o.writeByte(a),o.writeByte(0)},R=function(){o.writeByte(33),o.writeByte(254),o.writeByte(C.length),o.writeUTFBytes(C),o.writeByte(0)},j=function(){o.writeByte(44),z(0),z(0),z(r),z(i),b?o.writeByte(0):o.writeByte(128|v)},G=function(){z(r),z(i),o.writeByte(240|v),o.writeByte(0),o.writeByte(0)},L=function(){o.writeByte(33),o.writeByte(255),o.writeByte(11),o.writeUTFBytes("NETSCAPE2.0"),o.writeByte(3),o.writeByte(1),z(h),o.writeByte(0)},S=function(){o.writeBytes(s);for(var t=768-s.length,e=0;e<t;e++)o.writeByte(0)},z=function(t){o.writeByte(255&t),o.writeByte(t>>8&255)},M=function(){new LZWEncoder(r,i,u,f).encode(o)};w.stream=function(){return o},w.setProperties=function(t,e){B=t,b=e};return w};
},{}],"AWxG":[function(require,module,exports) {
"use strict";var t=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))(function(i,o){function c(t){try{s(a.next(t))}catch(e){o(e)}}function r(t){try{s(a.throw(t))}catch(e){o(e)}}function s(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(c,r)}s((a=a.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});class e{augment(e,n,a){return t(this,void 0,void 0,function*(){const{hatWidth:t,hatHeight:i}=this.calculateHatSize(e);for(const{frame:o,pose:c}of e){const e=yield createImageBitmap(o);n.drawImage(e,0,0,n.canvas.width,n.canvas.height);const r=c.keypoints.find(({name:t})=>"right_wrist"===t);r&&n.fillRect(r.x+t/2,r.y-i,t,i),a.addFrame(n,!1)}})}calculateHatSize(t){let e=40,n=20;for(const{pose:a}of t){const t=a.keypoints.find(({name:t})=>"left_eye"===t);if(!t)continue;const i=a.keypoints.find(({name:t})=>"right_eye"===t);if(i)return{hatWidth:e=2*Math.abs(t.x-i.x),hatHeight:n=e}}return{hatWidth:e,hatHeight:n}}}exports.default=e;
},{}],"xtzj":[function(require,module,exports) {
"use strict";var e=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))(function(r,i){function a(e){try{u(s.next(e))}catch(t){i(t)}}function o(e){try{u(s.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,o)}u((s=s.apply(e,t||[])).next())})},t=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),require("./js/LZWEncoder.js"),require("./js/NeuQuant.js"),require("./js/GIFEncoder.js");const n=t(require("./movement-augmenters/hat")),s=self;let r=void 0,i=void 0,a=void 0,o=new n.default;const u=new self.GIFEncoder;u.setRepeat(0),u.start(),s.addEventListener("message",({data:t})=>e(void 0,void 0,void 0,function*(){switch(t.type){case"gif:setOptions":i=t.width,a=t.height,u.setSize(i,a),u.setDelay(t.delay);const e=new OffscreenCanvas(i,a);r=e.getContext("2d");break;case"gif:addFrames":r.fillStyle="lightgreen",yield o.augment(t.frames,r,u),u.finish();const{bin:n}=u.stream(),c=URL.createObjectURL(new Blob([new Uint8Array(n)],{type:"image/gif"}));s.postMessage({type:"gif:url",url:c}),u.start();break;default:throw new Error(`unexpected message type: ${t.type}`)}}));
},{"./js/LZWEncoder.js":"Oo4e","./js/NeuQuant.js":"cKHy","./js/GIFEncoder.js":"Zeem","./movement-augmenters/hat":"AWxG"}]},{},["xtzj"], null)
//# sourceMappingURL=gif_worker.933bf1d5.js.map